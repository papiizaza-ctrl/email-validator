<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Email Validator</title>
    <style>
        :root {
            --primary: #00d4ff;
            --secondary: #7c3aed;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --navy: #0f172a;
            --navy-light: #1e293b;
            --navy-lighter: #334155;
            --text-light: #e2e8f0;
            --text-muted: #94a3b8;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'Segoe UI', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: var(--text-light);
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            padding: 30px;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 40px 20px;
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(124, 58, 237, 0.1));
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        h1 {
            font-size: 3rem;
            margin-bottom: 15px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 800;
        }
        
        .subtitle {
            font-size: 1.2rem;
            color: var(--text-muted);
        }
        
        .api-config {
            background: var(--navy-light);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        .section-title {
            font-size: 1.5rem;
            margin-bottom: 25px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title::before {
            content: '';
            width: 4px;
            height: 28px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 2px;
        }
        
        .config-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-light);
            font-size: 0.95rem;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 14px 18px;
            background: var(--navy-lighter);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            font-size: 1rem;
            color: var(--text-light);
            transition: all 0.3s ease;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(0, 212, 255, 0.1);
        }
        
        .api-status {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 15px 20px;
            background: var(--navy-lighter);
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background-color: var(--text-muted);
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .status-connected {
            background-color: var(--success);
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .config-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
        }
        
        .card {
            background: var(--navy-light);
            border-radius: 16px;
            padding: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        
        textarea {
            height: 200px;
            resize: vertical;
            margin-bottom: 20px;
            font-family: 'Courier New', monospace;
        }
        
        .button-group {
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        button::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            transform: translate(-50%, -50%);
            transition: width 0.6s, height 0.6s;
        }
        
        button:hover::before {
            width: 300px;
            height: 300px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
        }
        
        .btn-secondary {
            background: var(--navy-lighter);
            color: var(--text-light);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .btn-success {
            background: var(--success);
            color: white;
        }
        
        .btn-warning {
            background: var(--warning);
            color: white;
        }
        
        .btn-filter {
            background: var(--navy-lighter);
            color: var(--text-light);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .btn-filter.active {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border-color: transparent;
        }
        
        button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }
        
        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .progress-container {
            margin-bottom: 25px;
        }
        
        .progress-bar {
            height: 12px;
            background: var(--navy-lighter);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            width: 0%;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.5);
        }
        
        #progressText {
            margin-top: 8px;
            text-align: center;
            color: var(--text-muted);
            font-size: 0.9rem;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background: var(--navy-lighter);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }
        
        .stat-value {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .valid { color: var(--success); }
        .invalid { color: var(--danger); }
        .risky { color: var(--warning); }
        .unknown { color: var(--text-muted); }
        
        .categories {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .category {
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .category-header {
            padding: 16px 20px;
            color: white;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .valid-emails .category-header { 
            background: linear-gradient(135deg, var(--success), #059669);
        }
        .invalid-emails .category-header { 
            background: linear-gradient(135deg, var(--danger), #dc2626);
        }
        .risky-emails .category-header { 
            background: linear-gradient(135deg, var(--warning), #d97706);
        }
        .unknown-emails .category-header { 
            background: linear-gradient(135deg, #64748b, #475569);
        }
        
        .category-badge {
            background: rgba(255, 255, 255, 0.2);
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        
        .category-content {
            max-height: 300px;
            overflow-y: auto;
            background: var(--navy-lighter);
        }
        
        .category-content::-webkit-scrollbar {
            width: 8px;
        }
        
        .category-content::-webkit-scrollbar-track {
            background: var(--navy);
        }
        
        .category-content::-webkit-scrollbar-thumb {
            background: var(--navy-lighter);
            border-radius: 4px;
        }
        
        .email-item {
            padding: 12px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .email-item:last-child {
            border-bottom: none;
        }
        
        .email-item:hover {
            background: var(--navy);
        }
        
        .email-main {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-dot {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            flex-shrink: 0;
        }
        
        .status-valid { background-color: var(--success); }
        .status-invalid { background-color: var(--danger); }
        .status-risky { background-color: var(--warning); }
        .status-unknown { background-color: var(--text-muted); }
        
        .validation-details {
            font-size: 0.85rem;
            color: var(--text-muted);
            padding-left: 20px;
        }
        
        .provider-stats {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            margin-bottom: 25px;
        }
        
        .provider-stat-card {
            background: var(--navy-lighter);
            padding: 18px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }
        
        .provider-stat-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3);
        }
        
        .provider-stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .provider-stat-label {
            font-size: 0.85rem;
            color: var(--text-muted);
        }
        
        .office { color: #d83b01; }
        .zoho { color: #e11f26; }
        .gmail { color: #ea4335; }
        .yahoo { color: #720e9e; }
        .other { color: var(--primary); }
        
        .provider-section {
            margin-top: 30px;
        }
        
        .provider-tabs {
            display: flex;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .provider-tab {
            padding: 12px 24px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 600;
            color: var(--text-muted);
            transition: all 0.3s ease;
            border-radius: 8px 8px 0 0;
        }
        
        .provider-tab:hover {
            background: var(--navy-lighter);
            color: var(--text-light);
        }
        
        .provider-tab.active {
            border-bottom-color: var(--primary);
            color: var(--primary);
            background: var(--navy-lighter);
        }
        
        .provider-content {
            display: none;
        }
        
        .provider-content.active {
            display: block;
        }
        
        .provider-emails {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 12px;
            max-height: 400px;
            overflow-y: auto;
            padding: 15px;
            background: var(--navy-lighter);
            border-radius: 12px;
        }
        
        .provider-email-item {
            padding: 10px 15px;
            background: var(--navy);
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }
        
        .provider-email-item:hover {
            border-color: var(--primary);
            transform: translateX(4px);
        }
        
        .api-info {
            background: linear-gradient(135deg, rgba(0, 212, 255, 0.1), rgba(124, 58, 237, 0.1));
            border-radius: 12px;
            padding: 20px;
            margin-top: 25px;
            border-left: 4px solid var(--primary);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .api-info h3 {
            margin-bottom: 15px;
            color: var(--primary);
            font-size: 1.2rem;
        }
        
        .api-info ul {
            padding-left: 20px;
            color: var(--text-muted);
        }
        
        .api-info li {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        .api-info strong {
            color: var(--text-light);
        }
        
        footer {
            text-align: center;
            margin-top: 50px;
            padding: 30px;
            color: var(--text-muted);
            font-size: 0.95rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .footer-content {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }
        
        .designed-by {
            font-size: 1.1rem;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 700;
        }
        
        .file-upload-container {
            margin-bottom: 20px;
            padding: 20px;
            background: var(--navy-lighter);
            border-radius: 10px;
            border: 2px dashed rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .file-upload-container:hover {
            border-color: var(--primary);
            background: rgba(0, 212, 255, 0.05);
        }
        
        .file-upload-container.dragover {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.1);
        }
        
        .file-input {
            display: none;
        }
        
        .file-label {
            display: block;
            padding: 15px;
            cursor: pointer;
            color: var(--text-light);
            font-weight: 600;
        }
        
        .file-label i {
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
            color: var(--primary);
        }
        
        .file-info {
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--text-muted);
        }
        
        .file-name {
            margin-top: 10px;
            font-weight: 600;
            color: var(--primary);
        }
        
        /* New enhanced styles */
        .validation-settings {
            background: var(--navy-lighter);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .setting-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .setting-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }
        
        .batch-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .batch-input {
            width: 80px !important;
            text-align: center;
        }
        
        .validation-speed {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .speed-slider {
            flex: 1;
            -webkit-appearance: none;
            height: 6px;
            background: var(--navy);
            border-radius: 3px;
            outline: none;
        }
        
        .speed-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
        }
        
        .history-panel {
            margin-top: 30px;
            background: var(--navy-light);
            border-radius: 16px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .history-item {
            padding: 12px 15px;
            background: var(--navy-lighter);
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid var(--primary);
        }
        
        .history-info {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .history-stats {
            display: flex;
            gap: 15px;
            font-size: 0.85rem;
            color: var(--text-muted);
        }
        
        .history-date {
            font-size: 0.8rem;
            color: var(--text-muted);
        }
        
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background: var(--success);
            color: white;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            transform: translateX(150%);
            transition: transform 0.3s ease;
            z-index: 1000;
        }
        
        .toast.show {
            transform: translateX(0);
        }
        
        .toast.error {
            background: var(--danger);
        }
        
        .toast.warning {
            background: var(--warning);
        }
        
        .analytics-chart {
            background: var(--navy-lighter);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            height: 200px;
            display: flex;
            align-items: flex-end;
            gap: 10px;
            justify-content: center;
        }
        
        .chart-bar {
            background: linear-gradient(to top, var(--primary), var(--secondary));
            width: 40px;
            border-radius: 4px 4px 0 0;
            transition: height 0.5s ease;
            position: relative;
        }
        
        .chart-bar:hover::after {
            content: attr(data-value);
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--navy);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            white-space: nowrap;
        }
        
        .duplicate-warning {
            background: var(--warning);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: none;
        }
        
        .bulk-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .action-btn {
            padding: 8px 16px;
            font-size: 0.85rem;
        }
        
        @media (max-width: 768px) {
            .stats, .provider-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .categories {
                grid-template-columns: 1fr;
            }
            
            .provider-emails {
                grid-template-columns: 1fr;
            }
            
            .settings-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>‚ö° Email Validator Pro</h1>
            <p class="subtitle">Advanced email verification with comprehensive analytics</p>
        </header>
        
        <section class="api-config">
            <h2 class="section-title">API Configuration</h2>
            <div class="config-grid">
                <div class="form-group">
                    <label for="apiProvider">Select Email Validation API</label>
                    <select id="apiProvider">
                        <option value="abstract">Abstract API</option>
                        <option value="zerobounce">ZeroBounce</option>
                        <option value="hunter">Hunter.io</option>
                        <option value="quickemail">QuickEmailVerification</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="apiKey">API Key (Required for live APIs)</label>
                    <input type="password" id="apiKey" placeholder="Enter your API key here">
                </div>
            </div>
            
            <div class="validation-settings">
                <h3 class="section-title">‚öôÔ∏è Validation Settings</h3>
                <div class="settings-grid">
                    <div class="setting-item">
                        <input type="checkbox" id="checkDisposable" checked>
                        <label for="checkDisposable">Detect Disposable Emails</label>
                    </div>
                    <div class="setting-item">
                        <input type="checkbox" id="checkRoleBased" checked>
                        <label for="checkRoleBased">Detect Role-based Accounts</label>
                    </div>
                    <div class="setting-item">
                        <input type="checkbox" id="checkMXRecords" checked>
                        <label for="checkMXRecords">Verify MX Records</label>
                    </div>
                    <div class="setting-item">
                        <input type="checkbox" id="checkSMTP" checked>
                        <label for="checkSMTP">SMTP Verification</label>
                    </div>
                </div>
                
                <div class="batch-controls">
                    <label for="batchSize">Batch Size:</label>
                    <input type="number" id="batchSize" class="batch-input" value="10" min="1" max="50">
                    <span class="file-info">(Higher = faster but may trigger rate limits)</span>
                </div>
                
                <div class="validation-speed">
                    <label for="speedControl">Validation Speed:</label>
                    <input type="range" id="speedControl" class="speed-slider" min="1" max="10" value="5">
                    <span id="speedValue">Medium</span>
                </div>
            </div>
            
            <div class="api-status">
                <span class="status-dot" id="apiStatusDot"></span>
                <span id="apiStatusText">Not connected - Click "Test API Connection" to verify</span>
            </div>
            
            <div class="api-info">
                <h3>üìä About Email Validation APIs</h3>
                <p>Professional email validation APIs perform comprehensive checks including:</p>
                <ul>
                    <li><strong>Syntax Validation</strong> - Verifies email format correctness</li>
                    <li><strong>Domain Verification</strong> - Checks MX records and domain existence</li>
                    <li><strong>Mailbox Verification</strong> - Confirms if mailbox actually exists</li>
                    <li><strong>Disposable Email Detection</strong> - Identifies temporary email addresses</li>
                    <li><strong>Role Account Detection</strong> - Flags generic addresses (info@, admin@)</li>
                </ul>
                <p><strong>Popular Services:</strong> AbstractAPI, ZeroBounce, Hunter.io, QuickEmailVerification</p>
            </div>
        </section>
        
        <div class="main-content">
            <section class="card">
                <h2 class="section-title">üìß Input Emails</h2>
                
                <div class="file-upload-container" id="fileUploadContainer">
                    <input type="file" id="fileInput" class="file-input" accept=".txt,.csv,.xlsx">
                    <label for="fileInput" class="file-label">
                        <i>üìÅ</i>
                        Click to upload or drag & drop email file
                        <div class="file-info">Supports .txt, .csv, and .xlsx files (one email per line)</div>
                    </label>
                    <div class="file-name" id="fileName"></div>
                </div>
                
                <div class="duplicate-warning" id="duplicateWarning">
                    ‚ö†Ô∏è Duplicate emails detected and removed
                </div>
                
                <textarea id="emailInput" placeholder="Or paste emails directly (one per line or comma-separated)
Example:
john.doe@gmail.com
jane.smith@company.com
admin@example.org

You can paste up to 5000 emails at once!"></textarea>
                
                <div class="bulk-actions">
                    <button id="removeDuplicates" class="btn-warning action-btn">üîÑ Remove Duplicates</button>
                    <button id="sortEmails" class="btn-secondary action-btn">üî† Sort A-Z</button>
                    <button id="countEmails" class="btn-secondary action-btn">üî¢ Count Emails</button>
                </div>
                
                <div class="button-group">
                    <button id="validateBtn" class="btn-primary">üöÄ Validate Emails</button>
                    <button id="pauseBtn" class="btn-warning" style="display: none;">‚è∏Ô∏è Pause</button>
                    <button id="resumeBtn" class="btn-success" style="display: none;">‚ñ∂Ô∏è Resume</button>
                    <button id="clearBtn" class="btn-secondary">üóëÔ∏è Clear All</button>
                    <button id="testApiBtn" class="btn-success">üîå Test API Connection</button>
                </div>
                
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress" id="progressBar"></div>
                    </div>
                    <div id="progressText">0% Complete (0/0 emails)</div>
                </div>
                
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-value valid" id="validCount">0</div>
                        <div class="stat-label">Valid</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value invalid" id="invalidCount">0</div>
                        <div class="stat-label">Invalid</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value risky" id="riskyCount">0</div>
                        <div class="stat-label">Risky</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value unknown" id="unknownCount">0</div>
                        <div class="stat-label">Unknown</div>
                    </div>
                </div>
                
                <div class="analytics-chart" id="analyticsChart">
                    <!-- Chart bars will be generated dynamically -->
                </div>
                
                <div class="provider-filters">
                    <div class="filter-title">üîç Filter by Provider:</div>
                    <div class="button-group">
                        <button class="btn-filter active" data-provider="all">All Providers</button>
                        <button class="btn-filter" data-provider="office">Office 365</button>
                        <button class="btn-filter" data-provider="zoho">Zoho</button>
                        <button class="btn-filter" data-provider="gmail">Gmail</button>
                        <button class="btn-filter" data-provider="yahoo">Yahoo</button>
                        <button class="btn-filter" data-provider="other">Other</button>
                    </div>
                </div>
                
                <div class="button-group">
                    <button id="exportValid" class="btn-primary">üíæ Export Valid Emails</button>
                    <button id="exportAll" class="btn-secondary">üìä Export All Results</button>
                    <button id="saveSession" class="btn-secondary">üíæ Save Session</button>
                </div>
            </section>
            
            <section class="card">
                <h2 class="section-title">üìä Validation Results</h2>
                
                <div class="provider-stats">
                    <div class="provider-stat-card">
                        <div class="provider-stat-value office" id="officeCount">0</div>
                        <div class="provider-stat-label">Office 365</div>
                    </div>
                    <div class="provider-stat-card">
                        <div class="provider-stat-value zoho" id="zohoCount">0</div>
                        <div class="provider-stat-label">Zoho</div>
                    </div>
                    <div class="provider-stat-card">
                        <div class="provider-stat-value gmail" id="gmailCount">0</div>
                        <div class="provider-stat-label">Gmail</div>
                    </div>
                    <div class="provider-stat-card">
                        <div class="provider-stat-value yahoo" id="yahooCount">0</div>
                        <div class="provider-stat-label">Yahoo</div>
                    </div>
                    <div class="provider-stat-card">
                        <div class="provider-stat-value other" id="otherCount">0</div>
                        <div class="provider-stat-label">Other</div>
                    </div>
                </div>
                
                <div class="categories">
                    <div class="category valid-emails">
                        <div class="category-header">
                            <span>‚úÖ Valid Emails</span>
                            <span class="category-badge" id="validBadge">0</span>
                        </div>
                        <div class="category-content" id="validList">
                            <div style="padding: 20px; text-align: center; color: var(--text-muted);">
                                No emails validated yet
                            </div>
                        </div>
                    </div>
                    
                    <div class="category invalid-emails">
                        <div class="category-header">
                            <span>‚ùå Invalid Emails</span>
                            <span class="category-badge" id="invalidBadge">0</span>
                        </div>
                        <div class="category-content" id="invalidList">
                            <div style="padding: 20px; text-align: center; color: var(--text-muted);">
                                No emails validated yet
                            </div>
                        </div>
                    </div>
                    
                    <div class="category risky-emails">
                        <div class="category-header">
                            <span>‚ö†Ô∏è Risky Emails</span>
                            <span class="category-badge" id="riskyBadge">0</span>
                        </div>
                        <div class="category-content" id="riskyList">
                            <div style="padding: 20px; text-align: center; color: var(--text-muted);">
                                No emails validated yet
                            </div>
                        </div>
                    </div>
                    
                    <div class="category unknown-emails">
                        <div class="category-header">
                            <span>‚ùì Unknown Emails</span>
                            <span class="category-badge" id="unknownBadge">0</span>
                        </div>
                        <div class="category-content" id="unknownList">
                            <div style="padding: 20px; text-align: center; color: var(--text-muted);">
                                No emails validated yet
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="provider-section">
                    <h3 class="section-title">üì® Emails by Provider</h3>
                    
                    <div class="provider-tabs">
                        <div class="provider-tab active" data-provider="office">Office 365</div>
                        <div class="provider-tab" data-provider="zoho">Zoho</div>
                        <div class="provider-tab" data-provider="gmail">Gmail</div>
                        <div class="provider-tab" data-provider="yahoo">Yahoo</div>
                        <div class="provider-tab" data-provider="other">Other</div>
                    </div>
                    
                    <div class="provider-content active" id="officeContent">
                        <div class="provider-emails" id="officeEmails">
                            <div style="padding: 20px; text-align: center; color: var(--text-muted); grid-column: 1/-1;">
                                No Office 365 emails found
                            </div>
                        </div>
                    </div>
                    
                    <div class="provider-content" id="zohoContent">
                        <div class="provider-emails" id="zohoEmails">
                            <div style="padding: 20px; text-align: center; color: var(--text-muted); grid-column: 1/-1;">
                                No Zoho emails found
                            </div>
                        </div>
                    </div>
                    
                    <div class="provider-content" id="gmailContent">
                        <div class="provider-emails" id="gmailEmails">
                            <div style="padding: 20px; text-align: center; color: var(--text-muted); grid-column: 1/-1;">
                                No Gmail emails found
                            </div>
                        </div>
                    </div>
                    
                    <div class="provider-content" id="yahooContent">
                        <div class="provider-emails" id="yahooEmails">
                            <div style="padding: 20px; text-align: center; color: var(--text-muted); grid-column: 1/-1;">
                                No Yahoo emails found
                            </div>
                        </div>
                    </div>
                    
                    <div class="provider-content" id="otherContent">
                        <div class="provider-emails" id="otherEmails">
                            <div style="padding: 20px; text-align: center; color: var(--text-muted); grid-column: 1/-1;">
                                No other emails found
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
        
        <section class="history-panel">
            <h2 class="section-title">üìã Validation History</h2>
            <div id="historyList">
                <div style="padding: 20px; text-align: center; color: var(--text-muted);">
                    No validation sessions yet
                </div>
            </div>
        </section>
        
        <footer>
            <div class="footer-content">
                <p>Professional Email Validator Tool</p>
                <p class="designed-by">Designed By @DarkSeid</p>
                <p>¬© 2025 Email Validator Pro. All rights reserved.</p>
            </div>
        </footer>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        // DOM Elements
        const emailInput = document.getElementById('emailInput');
        const validateBtn = document.getElementById('validateBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resumeBtn = document.getElementById('resumeBtn');
        const clearBtn = document.getElementById('clearBtn');
        const testApiBtn = document.getElementById('testApiBtn');
        const apiProvider = document.getElementById('apiProvider');
        const apiKey = document.getElementById('apiKey');
        const apiStatusDot = document.getElementById('apiStatusDot');
        const apiStatusText = document.getElementById('apiStatusText');
        const progressBar = document.getElementById('progressBar');
        const progressText = document.getElementById('progressText');
        const fileInput = document.getElementById('fileInput');
        const fileUploadContainer = document.getElementById('fileUploadContainer');
        const fileName = document.getElementById('fileName');
        const duplicateWarning = document.getElementById('duplicateWarning');
        const removeDuplicatesBtn = document.getElementById('removeDuplicates');
        const sortEmailsBtn = document.getElementById('sortEmails');
        const countEmailsBtn = document.getElementById('countEmails');
        const batchSizeInput = document.getElementById('batchSize');
        const speedControl = document.getElementById('speedControl');
        const speedValue = document.getElementById('speedValue');
        const analyticsChart = document.getElementById('analyticsChart');
        const exportValid = document.getElementById('exportValid');
        const exportAll = document.getElementById('exportAll');
        const saveSessionBtn = document.getElementById('saveSession');
        const historyList = document.getElementById('historyList');
        const toast = document.getElementById('toast');
        
        // Stat elements
        const validCount = document.getElementById('validCount');
        const invalidCount = document.getElementById('invalidCount');
        const riskyCount = document.getElementById('riskyCount');
        const unknownCount = document.getElementById('unknownCount');
        
        // Provider count elements
        const officeCount = document.getElementById('officeCount');
        const zohoCount = document.getElementById('zohoCount');
        const gmailCount = document.getElementById('gmailCount');
        const yahooCount = document.getElementById('yahooCount');
        const otherCount = document.getElementById('otherCount');
        
        // Badge elements
        const validBadge = document.getElementById('validBadge');
        const invalidBadge = document.getElementById('invalidBadge');
        const riskyBadge = document.getElementById('riskyBadge');
        const unknownBadge = document.getElementById('unknownBadge');
        
        // List elements
        const validList = document.getElementById('validList');
        const invalidList = document.getElementById('invalidList');
        const riskyList = document.getElementById('riskyList');
        const unknownList = document.getElementById('unknownList');
        
        // Provider email lists
        const officeEmails = document.getElementById('officeEmails');
        const zohoEmails = document.getElementById('zohoEmails');
        const gmailEmails = document.getElementById('gmailEmails');
        const yahooEmails = document.getElementById('yahooEmails');
        const otherEmails = document.getElementById('otherEmails');
        
        // State variables
        let validationResults = [];
        let isApiConnected = false;
        let validationInterval = null;
        let isValidationPaused = false;
        let currentValidationIndex = 0;
        let currentEmails = [];
        let validationHistory = JSON.parse(localStorage.getItem('emailValidatorHistory')) || [];
        
        // Speed mapping
        const speedMap = {
            1: { value: 2000, label: 'Very Slow' },
            2: { value: 1500, label: 'Slow' },
            3: { value: 1000, label: 'Below Average' },
            4: { value: 750, label: 'Slightly Slow' },
            5: { value: 500, label: 'Medium' },
            6: { value: 350, label: 'Slightly Fast' },
            7: { value: 250, label: 'Fast' },
            8: { value: 150, label: 'Very Fast' },
            9: { value: 75, label: 'Extremely Fast' },
            10: { value: 25, label: 'Maximum' }
        };

        // Initialize the application
        function init() {
            // Event listeners
            validateBtn.addEventListener('click', validateEmails);
            pauseBtn.addEventListener('click', pauseValidation);
            resumeBtn.addEventListener('click', resumeValidation);
            clearBtn.addEventListener('click', clearAll);
            testApiBtn.addEventListener('click', testApiConnection);
            exportValid.addEventListener('click', exportValidEmails);
            exportAll.addEventListener('click', exportAllResults);
            saveSessionBtn.addEventListener('click', saveSession);
            
            // File upload events
            fileInput.addEventListener('change', handleFileUpload);
            setupDragAndDrop();
            
            // Bulk action events
            removeDuplicatesBtn.addEventListener('click', removeDuplicateEmails);
            sortEmailsBtn.addEventListener('click', sortEmails);
            countEmailsBtn.addEventListener('click', countEmails);
            
            // Settings events
            speedControl.addEventListener('input', updateSpeed);
            batchSizeInput.addEventListener('change', validateBatchSize);
            
            // Provider tab switching
            document.querySelectorAll('.provider-tab').forEach(tab => {
                tab.addEventListener('click', switchProviderTab);
            });
            
            // Filter buttons
            document.querySelectorAll('.btn-filter').forEach(btn => {
                btn.addEventListener('click', toggleFilter);
            });
            
            // Load validation history
            loadValidationHistory();
            
            // Update API status
            updateApiStatus(false, 'Not connected - Click "Test API Connection" to verify');
        }
        
        // Show toast notification
        function showToast(message, type = 'success') {
            toast.textContent = message;
            toast.className = 'toast';
            toast.classList.add(type);
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Update validation speed
        function updateSpeed() {
            const speed = parseInt(speedControl.value);
            speedValue.textContent = speedMap[speed].label;
        }
        
        // Validate batch size
        function validateBatchSize() {
            let value = parseInt(batchSizeInput.value);
            if (value < 1) value = 1;
            if (value > 50) value = 50;
            batchSizeInput.value = value;
        }
        
        // Remove duplicate emails
        function removeDuplicateEmails() {
            const emails = parseEmailInput();
            if (emails.length === 0) return;
            
            const uniqueEmails = [...new Set(emails)];
            const duplicatesRemoved = emails.length - uniqueEmails.length;
            
            if (duplicatesRemoved > 0) {
                emailInput.value = uniqueEmails.join('\n');
                duplicateWarning.style.display = 'block';
                duplicateWarning.textContent = `‚ö†Ô∏è ${duplicatesRemoved} duplicate emails removed`;
                showToast(`${duplicatesRemoved} duplicate emails removed`, 'warning');
            } else {
                showToast('No duplicate emails found', 'success');
            }
        }
        
        // Sort emails alphabetically
        function sortEmails() {
            const emails = parseEmailInput();
            if (emails.length === 0) return;
            
            const sortedEmails = emails.sort((a, b) => a.localeCompare(b));
            emailInput.value = sortedEmails.join('\n');
            showToast('Emails sorted alphabetically', 'success');
        }
        
        // Count emails
        function countEmails() {
            const emails = parseEmailInput();
            showToast(`Found ${emails.length} email addresses`, 'success');
        }
        
        // Setup drag and drop functionality
        function setupDragAndDrop() {
            // Prevent default drag behaviors
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                fileUploadContainer.addEventListener(eventName, preventDefaults, false);
                document.body.addEventListener(eventName, preventDefaults, false);
            });
            
            // Highlight drop area when item is dragged over it
            ['dragenter', 'dragover'].forEach(eventName => {
                fileUploadContainer.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                fileUploadContainer.addEventListener(eventName, unhighlight, false);
            });
            
            // Handle dropped files
            fileUploadContainer.addEventListener('drop', handleDrop, false);
        }
        
        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }
        
        function highlight() {
            fileUploadContainer.classList.add('dragover');
        }
        
        function unhighlight() {
            fileUploadContainer.classList.remove('dragover');
        }
        
        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            
            if (files.length) {
                fileInput.files = files;
                handleFileUpload();
            }
        }
        
        // Handle file upload
        function handleFileUpload() {
            const file = fileInput.files[0];
            if (!file) return;
            
            // Check file type
            const fileType = file.name.split('.').pop().toLowerCase();
            if (!['txt', 'csv', 'xlsx'].includes(fileType)) {
                alert('Please upload a .txt, .csv, or .xlsx file');
                return;
            }
            
            // Update UI
            fileName.textContent = `Selected file: ${file.name}`;
            
            // Read file content
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                emailInput.value = content;
                showToast(`File "${file.name}" loaded successfully`, 'success');
            };
            reader.readAsText(file);
        }
        
        // Validate emails
        function validateEmails() {
            const emails = parseEmailInput();
            
            if (emails.length === 0) {
                showToast('Please enter at least one email address or upload a file', 'error');
                return;
            }
            
            if (emails.length > 5000) {
                showToast('Maximum 5000 emails allowed. Please reduce your input.', 'error');
                return;
            }
            
            // Reset state
            validationResults = [];
            resetStats();
            resetLists();
            currentValidationIndex = 0;
            currentEmails = emails;
            isValidationPaused = false;
            
            // Update UI
            validateBtn.style.display = 'none';
            pauseBtn.style.display = 'inline-block';
            resumeBtn.style.display = 'none';
            
            // Start validation
            startValidation();
        }
        
        // Start validation process
        function startValidation() {
            const batchSize = parseInt(batchSizeInput.value);
            const speed = parseInt(speedControl.value);
            const delay = speedMap[speed].value;
            
            validationInterval = setInterval(() => {
                if (isValidationPaused || currentValidationIndex >= currentEmails.length) {
                    if (currentValidationIndex >= currentEmails.length) {
                        completeValidation();
                    }
                    return;
                }
                
                // Process batch of emails
                const endIndex = Math.min(currentValidationIndex + batchSize, currentEmails.length);
                for (let i = currentValidationIndex; i < endIndex; i++) {
                    const email = currentEmails[i];
                    const result = validateSingleEmail(email);
                    validationResults.push(result);
                    updateUIWithResult(result);
                }
                
                currentValidationIndex = endIndex;
                
                // Update progress
                const progress = (currentValidationIndex / currentEmails.length) * 100;
                progressBar.style.width = `${progress}%`;
                progressText.textContent = `${Math.round(progress)}% Complete (${currentValidationIndex}/${currentEmails.length} emails)`;
            }, delay);
        }
        
        // Pause validation
        function pauseValidation() {
            isValidationPaused = true;
            pauseBtn.style.display = 'none';
            resumeBtn.style.display = 'inline-block';
            showToast('Validation paused', 'warning');
        }
        
        // Resume validation
        function resumeValidation() {
            isValidationPaused = false;
            pauseBtn.style.display = 'inline-block';
            resumeBtn.style.display = 'none';
            showToast('Validation resumed', 'success');
        }
        
        // Complete validation
        function completeValidation() {
            clearInterval(validationInterval);
            validateBtn.style.display = 'inline-block';
            pauseBtn.style.display = 'none';
            resumeBtn.style.display = 'none';
            
            // Update analytics chart
            updateAnalyticsChart();
            
            // Save to history
            saveToHistory();
            
            showToast(`Validation complete! Processed ${currentEmails.length} emails`, 'success');
        }
        
        // Update analytics chart
        function updateAnalyticsChart() {
            const statusCounts = {
                valid: validationResults.filter(r => r.status === 'valid').length,
                invalid: validationResults.filter(r => r.status === 'invalid').length,
                risky: validationResults.filter(r => r.status === 'risky').length,
                unknown: validationResults.filter(r => r.status === 'unknown').length
            };
            
            const maxCount = Math.max(...Object.values(statusCounts));
            analyticsChart.innerHTML = '';
            
            Object.entries(statusCounts).forEach(([status, count]) => {
                const bar = document.createElement('div');
                bar.className = 'chart-bar';
                bar.style.height = maxCount > 0 ? `${(count / maxCount) * 100}%` : '0%';
                bar.setAttribute('data-value', count);
                
                const label = document.createElement('div');
                label.textContent = status.charAt(0).toUpperCase() + status.slice(1);
                label.style.textAlign = 'center';
                label.style.marginTop = '5px';
                label.style.fontSize = '0.8rem';
                label.style.color = 'var(--text-muted)';
                
                const container = document.createElement('div');
                container.style.display = 'flex';
                container.style.flexDirection = 'column';
                container.style.alignItems = 'center';
                container.appendChild(bar);
                container.appendChild(label);
                
                analyticsChart.appendChild(container);
            });
        }
        
        // Save to validation history
        function saveToHistory() {
            const session = {
                id: Date.now(),
                date: new Date().toLocaleString(),
                total: currentEmails.length,
                valid: validationResults.filter(r => r.status === 'valid').length,
                invalid: validationResults.filter(r => r.status === 'invalid').length,
                risky: validationResults.filter(r => r.status === 'risky').length,
                unknown: validationResults.filter(r => r.status === 'unknown').length
            };
            
            validationHistory.unshift(session);
            if (validationHistory.length > 10) {
                validationHistory = validationHistory.slice(0, 10);
            }
            
            localStorage.setItem('emailValidatorHistory', JSON.stringify(validationHistory));
            loadValidationHistory();
        }
        
        // Load validation history
        function loadValidationHistory() {
            if (validationHistory.length === 0) {
                historyList.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--text-muted);">No validation sessions yet</div>';
                return;
            }
            
            historyList.innerHTML = '';
            validationHistory.forEach(session => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                
                historyItem.innerHTML = `
                    <div class="history-info">
                        <div>Session ${new Date(session.id).toLocaleDateString()}</div>
                        <div class="history-stats">
                            <span class="valid">${session.valid} Valid</span>
                            <span class="invalid">${session.invalid} Invalid</span>
                            <span class="risky">${session.risky} Risky</span>
                            <span class="unknown">${session.unknown} Unknown</span>
                        </div>
                    </div>
                    <div class="history-date">${session.date}</div>
                `;
                
                historyList.appendChild(historyItem);
            });
        }
        
        // Save current session
        function saveSession() {
            if (validationResults.length === 0) {
                showToast('No validation results to save', 'error');
                return;
            }
            
            const sessionData = {
                emails: currentEmails,
                results: validationResults,
                timestamp: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(sessionData);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const url = URL.createObjectURL(dataBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `email-validation-session-${Date.now()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showToast('Session saved successfully', 'success');
        }
        
        // Parse email input
        function parseEmailInput() {
            const input = emailInput.value.trim();
            if (!input) return [];
            
            // Split by new lines or commas
            return input.split(/[\n,]+/)
                .map(email => email.trim())
                .filter(email => email.length > 0);
        }
        
        // Validate a single email (mock implementation)
        function validateSingleEmail(email) {
            // Simple regex for basic email validation
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            const isValidFormat = emailRegex.test(email);
            
            if (!isValidFormat) {
                return {
                    email,
                    status: 'invalid',
                    reason: 'Invalid email format',
                    provider: getEmailProvider(email)
                };
            }
            
            // Mock validation results based on email content
            let status, reason;
            const random = Math.random();
            
            if (random < 0.6) {
                status = 'valid';
                reason = 'Valid email address';
            } else if (random < 0.8) {
                status = 'risky';
                reason = 'Possible disposable or role-based email';
            } else if (random < 0.9) {
                status = 'invalid';
                reason = 'Domain does not exist';
            } else {
                status = 'unknown';
                reason = 'Could not verify email';
            }
            
            return {
                email,
                status,
                reason,
                provider: getEmailProvider(email)
            };
        }
        
        // Get email provider
        function getEmailProvider(email) {
            const domain = email.split('@')[1]?.toLowerCase();
            
            if (!domain) return 'other';
            
            if (domain.includes('outlook') || domain.includes('office') || domain.includes('microsoft')) {
                return 'office';
            } else if (domain.includes('gmail') || domain.includes('googlemail')) {
                return 'gmail';
            } else if (domain.includes('yahoo')) {
                return 'yahoo';
            } else if (domain.includes('zoho')) {
                return 'zoho';
            } else {
                return 'other';
            }
        }
        
        // Update UI with validation result
        function updateUIWithResult(result) {
            // Update counters
            updateCounters(result.status, result.provider);
            
            // Add to appropriate list
            addEmailToList(result);
            
            // Update provider-specific lists
            addEmailToProviderList(result);
        }
        
        // Update counters
        function updateCounters(status, provider) {
            // Update status counters
            const statusCounters = {
                'valid': validCount,
                'invalid': invalidCount,
                'risky': riskyCount,
                'unknown': unknownCount
            };
            
            if (statusCounters[status]) {
                const current = parseInt(statusCounters[status].textContent);
                statusCounters[status].textContent = current + 1;
            }
            
            // Update provider counters
            const providerCounters = {
                'office': officeCount,
                'zoho': zohoCount,
                'gmail': gmailCount,
                'yahoo': yahooCount,
                'other': otherCount
            };
            
            if (providerCounters[provider]) {
                const current = parseInt(providerCounters[provider].textContent);
                providerCounters[provider].textContent = current + 1;
            }
            
            // Update badges
            validBadge.textContent = validCount.textContent;
            invalidBadge.textContent = invalidCount.textContent;
            riskyBadge.textContent = riskyCount.textContent;
            unknownBadge.textContent = unknownCount.textContent;
        }
        
        // Add email to status list
        function addEmailToList(result) {
            const listContainers = {
                'valid': validList,
                'invalid': invalidList,
                'risky': riskyList,
                'unknown': unknownList
            };
            
            const container = listContainers[result.status];
            if (!container) return;
            
            // Remove placeholder if present
            if (container.querySelector('div') && container.querySelector('div').style.textAlign === 'center') {
                container.innerHTML = '';
            }
            
            const emailItem = document.createElement('div');
            emailItem.className = 'email-item';
            
            emailItem.innerHTML = `
                <div class="email-main">
                    <span class="status-dot status-${result.status}"></span>
                    <span>${result.email}</span>
                </div>
                <div class="validation-details">${result.reason}</div>
            `;
            
            container.appendChild(emailItem);
        }
        
        // Add email to provider list
        function addEmailToProviderList(result) {
            const providerContainers = {
                'office': officeEmails,
                'zoho': zohoEmails,
                'gmail': gmailEmails,
                'yahoo': yahooEmails,
                'other': otherEmails
            };
            
            const container = providerContainers[result.provider];
            if (!container) return;
            
            // Remove placeholder if present
            if (container.querySelector('div') && container.querySelector('div').style.textAlign === 'center') {
                container.innerHTML = '';
            }
            
            const emailItem = document.createElement('div');
            emailItem.className = 'provider-email-item';
            
            emailItem.innerHTML = `
                <span class="status-dot status-${result.status}"></span>
                <span>${result.email}</span>
            `;
            
            container.appendChild(emailItem);
        }
        
        // Test API connection
        function testApiConnection() {
            const provider = apiProvider.value;
            const key = apiKey.value.trim();
            
            if (!key) {
                showToast('Please enter your API key', 'error');
                return;
            }
            
            // Simulate API connection test
            testApiBtn.disabled = true;
            testApiBtn.textContent = 'Testing...';
            
            setTimeout(() => {
                const isConnected = Math.random() > 0.2; // 80% success rate for demo
                
                if (isConnected) {
                    updateApiStatus(true, `Connected to ${apiProvider.options[apiProvider.selectedIndex].text}`);
                    showToast('API connection successful', 'success');
                } else {
                    updateApiStatus(false, `Failed to connect to ${apiProvider.options[apiProvider.selectedIndex].text}. Check your API key.`);
                    showToast('API connection failed', 'error');
                }
                
                testApiBtn.disabled = false;
                testApiBtn.textContent = 'üîå Test API Connection';
            }, 2000);
        }
        
        // Update API status
        function updateApiStatus(connected, message) {
            isApiConnected = connected;
            apiStatusText.textContent = message;
            
            if (connected) {
                apiStatusDot.classList.add('status-connected');
            } else {
                apiStatusDot.classList.remove('status-connected');
            }
        }
        
        // Clear all inputs and results
        function clearAll() {
            emailInput.value = '';
            fileInput.value = '';
            fileName.textContent = '';
            duplicateWarning.style.display = 'none';
            validationResults = [];
            resetStats();
            resetLists();
            progressBar.style.width = '0%';
            progressText.textContent = '0% Complete (0/0 emails)';
            analyticsChart.innerHTML = '';
            
            validateBtn.style.display = 'inline-block';
            pauseBtn.style.display = 'none';
            resumeBtn.style.display = 'none';
            
            if (validationInterval) {
                clearInterval(validationInterval);
                validationInterval = null;
            }
            
            showToast('All data cleared', 'success');
        }
        
        // Reset statistics
        function resetStats() {
            validCount.textContent = '0';
            invalidCount.textContent = '0';
            riskyCount.textContent = '0';
            unknownCount.textContent = '0';
            
            officeCount.textContent = '0';
            zohoCount.textContent = '0';
            gmailCount.textContent = '0';
            yahooCount.textContent = '0';
            otherCount.textContent = '0';
            
            validBadge.textContent = '0';
            invalidBadge.textContent = '0';
            riskyBadge.textContent = '0';
            unknownBadge.textContent = '0';
        }
        
        // Reset lists
        function resetLists() {
            const lists = [validList, invalidList, riskyList, unknownList];
            const providerLists = [officeEmails, zohoEmails, gmailEmails, yahooEmails, otherEmails];
            
            lists.forEach(list => {
                list.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--text-muted);">No emails validated yet</div>';
            });
            
            providerLists.forEach(list => {
                list.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--text-muted); grid-column: 1/-1;">No emails found</div>';
            });
        }
        
        // Switch provider tabs
        function switchProviderTab(e) {
            const tab = e.currentTarget;
            const provider = tab.dataset.provider;
            
            // Update active tab
            document.querySelectorAll('.provider-tab').forEach(t => {
                t.classList.remove('active');
            });
            tab.classList.add('active');
            
            // Show corresponding content
            document.querySelectorAll('.provider-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${provider}Content`).classList.add('active');
        }
        
        // Toggle filter buttons
        function toggleFilter(e) {
            const button = e.currentTarget;
            const provider = button.dataset.provider;
            
            // Update active filter
            document.querySelectorAll('.btn-filter').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');
            
            // In a real implementation, this would filter the displayed results
            // For now, we'll just show a message
            console.log(`Filtering by: ${provider}`);
        }
        
        // Export valid emails
        function exportValidEmails() {
            if (validationResults.length === 0) {
                showToast('No validation results to export', 'error');
                return;
            }
            
            const validEmails = validationResults
                .filter(result => result.status === 'valid')
                .map(result => result.email);
            
            if (validEmails.length === 0) {
                showToast('No valid emails to export', 'warning');
                return;
            }
            
            const content = validEmails.join('\n');
            downloadCSV(content, 'valid-emails.csv');
            showToast(`${validEmails.length} valid emails exported`, 'success');
        }
        
        // Export all results
        function exportAllResults() {
            if (validationResults.length === 0) {
                showToast('No validation results to export', 'error');
                return;
            }
            
            const headers = 'Email,Status,Reason,Provider\n';
            const content = validationResults.map(result => 
                `"${result.email}","${result.status}","${result.reason}","${result.provider}"`
            ).join('\n');
            
            downloadCSV(headers + content, 'email-validation-results.csv');
            showToast('All validation results exported', 'success');
        }
        
        // Download CSV
        function downloadCSV(content, filename) {
            const blob = new Blob([content], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>